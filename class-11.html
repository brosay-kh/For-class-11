<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>11 - Memory Website - Bunsay</title>
<style>
* { margin:0; padding:0; box-sizing:border-box; }
body { background: linear-gradient(to bottom right, #1a1a2e, #16213e, #0f0f23); font-family:Georgia, serif; color:#fff; min-height:100vh; }
.container { max-width:1200px; margin:0 auto; padding:20px; }
.header { text-align:center; margin-bottom:40px; }
.class-name { font-size:4rem; font-weight:bold; background:linear-gradient(45deg,#ff6b9d,#c44569,#f8b500); -webkit-background-clip:text; -webkit-text-fill-color:transparent; margin-bottom:15px; text-shadow:0 0 30px rgba(255,107,157,0.5); }
.school-name { font-size:1.5rem; color:#e0e0e0; letter-spacing:2px; opacity:0.9; }
.upload-section { background: rgba(255,255,255,0.1); border-radius:20px; padding:30px; margin-bottom:40px; backdrop-filter:blur(10px); border:1px solid rgba(255,255,255,0.2); box-shadow:0 8px 32px rgba(0,0,0,0.3); }
.upload-area { border:3px dashed #ff6b9d; border-radius:15px; padding:40px; text-align:center; cursor:pointer; transition:all 0.3s ease; background: rgba(255,107,157,0.1); }
.upload-area:hover { background: rgba(255,107,157,0.2); transform:scale(1.02); }
.upload-area.dragover { background: rgba(255,107,157,0.3); border-color:#f8b500; }
.file-input { display:none; }
.memory-input { width:100%; padding:15px; background: rgba(255,255,255,0.1); border:2px solid rgba(255,107,157,0.3); border-radius:10px; color:#fff; font-size:1rem; margin-top:20px; resize:vertical; min-height:100px; }
.memory-input::placeholder { color: rgba(255,255,255,0.6); }
.add-memory-btn { background:linear-gradient(45deg,#ff6b9d,#c44569); color:white; border:none; padding:12px 30px; border-radius:25px; font-size:1rem; cursor:pointer; margin-top:15px; transition:all 0.3s ease; box-shadow:0 4px 15px rgba(255,107,157,0.3); }
.add-memory-btn:hover { transform:translateY(-2px); box-shadow:0 6px 20px rgba(255,107,157,0.4); }
.memories-grid { display:grid; grid-template-columns:repeat(auto-fit,minmax(350px,1fr)); gap:30px; margin-top:40px; }
.memory-card { background: rgba(255,255,255,0.1); border-radius:20px; padding:20px; backdrop-filter:blur(10px); border:1px solid rgba(255,255,255,0.2); position:relative; overflow:hidden; transition:all 0.3s ease; }
.memory-card:hover { transform:translateY(-5px); box-shadow:0 15px 40px rgba(0,0,0,0.3); }
.memory-image { width:100%; height:250px; object-fit:cover; border-radius:15px; margin-bottom:15px; position:relative; transition:opacity 0.3s ease; }
.memory-text { font-size:1rem; line-height:1.6; color:#e0e0e0; margin-bottom:15px; }
.memory-date { font-size:0.9rem; color:#ff6b9d; font-style:italic; }
.delete-btn { position:absolute; top:10px; right:10px; background:rgba(255,0,0,0.7); color:white; border:none; width:30px; height:30px; border-radius:50%; cursor:pointer; font-size:1rem; display:flex; align-items:center; justify-content:center; transition:all 0.3s ease; }
.delete-btn:hover { background:rgba(255,0,0,0.9); transform:scale(1.1); }
.memory-card-hearts { position:absolute; top:0; left:0; width:100%; height:100%; pointer-events:none; z-index:2; }
.memory-card-hearts .heart { font-size:0.8rem; opacity:0.7; }
@media (max-width:768px){ .class-name{font-size:2.5rem;} .school-name{font-size:1.2rem;} .memories-grid{grid-template-columns:1fr; gap:20px;} .upload-section{padding:20px;} }
.no-memories { text-align:center; color: rgba(255,255,255,0.6); font-size:1.2rem; margin:50px 0; }
.search-filter { background: rgba(255,255,255,0.1); border-radius:15px; padding:20px; margin-bottom:30px; backdrop-filter:blur(10px); border:1px solid rgba(255,255,255,0.2); }
.search-input { width:100%; padding:12px; background: rgba(255,255,255,0.1); border:2px solid rgba(255,107,157,0.3); border-radius:8px; color:#fff; font-size:1rem; }
.search-input::placeholder { color: rgba(255,255,255,0.6); }

</style>
</head>
<body>
  
<div class="container">
<div class="header">
<h1 class="class-name">11</h1>
<p class="school-name">·ûú·û∑.·ûÖ.·ûî ·ûè·üÅ·ûá·üÑ·ûü·üÇ·ûì·ûÄ·üÑ·üá·ûÄ·ûª·ûÑ</p>
<p>Create by Bunsay-11J</p>
</div>

<div class="search-filter">
<input type="text" class="search-input" id="searchInput" placeholder="Search memories..." onkeyup="filterMemories()">
</div>

<div class="upload-section">
<div class="upload-area" onclick="document.getElementById('fileInput').click()">
<div class="upload-icon">üì∑</div>
<div class="upload-text">Click or drag to upload your memory photo</div>
<small>Supports JPG, PNG, GIF (Max 5MB)·û†·û∂·ûò·ûõ·ûæ·ûüüòô</small>
</div>
<input type="file" id="fileInput" class="file-input" accept="image/*" capture="environment">
<img id="previewImage" style="max-width:200px; display:none; margin-top:10px;">
<textarea class="memory-input" id="memoryText" placeholder="Write your memory, thoughts, or anything you want to remember..."></textarea>
<button class="add-memory-btn" onclick="addMemory()">Post Memory</button>
</div>

<div class="memories-grid" id="memoriesGrid"></div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
import { getFirestore, collection, addDoc, onSnapshot, query, orderBy, deleteDoc, doc } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";
import { getStorage, ref, uploadBytes, getDownloadURL, deleteObject } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-storage.js";

const firebaseConfig = {
  apiKey: "AIzaSyAzVsFkYkMIt37YgJ_DVF19uWp1qgxuCLA",
  authDomain: "class-11-41a1d.appspot.com",
  projectId: "class-11-41a1d",
  storageBucket: "class-11-41a1d.appspot.com",
  messagingSenderId: "123503593619",
  appId: "1:123503593619:web:f0c502bf2ce1f14147e566",
  measurementId: "G-X387EWF5GW"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);
const storage = getStorage(app);
const memoriesCol = collection(db, "memories11J");

const previewImage = document.getElementById('previewImage');
const fileInput = document.getElementById('fileInput');
const uploadArea = document.querySelector('.upload-area');

let sizeDisplay = document.createElement('div');
sizeDisplay.style.marginTop = '5px';
sizeDisplay.style.color = '#fff';
uploadArea.appendChild(sizeDisplay);

fileInput.addEventListener('change', () => {
  const file = fileInput.files[0];
  if(!file) return;
  const reader = new FileReader();
  reader.onload = e => { 
    previewImage.src = e.target.result; 
    previewImage.style.display='block'; 
  }
  reader.readAsDataURL(file);
  const sizeInKB = (file.size / 1024).toFixed(2);
  const sizeInMB = (file.size / (1024*1024)).toFixed(2);
  sizeDisplay.textContent = `File size: ${sizeInKB} KB (${sizeInMB} MB)`;
});

function showSuccessMessage(text="Memory added successfully!"){
  const message=document.createElement('div');
  message.textContent=text;
  message.style.cssText="position:fixed;top:20px;right:20px;background:linear-gradient(45deg,#ff6b9d,#c44569);color:white;padding:15px 25px;border-radius:10px;z-index:1000;animation:slideIn 0.5s ease;";
  document.body.appendChild(message);
  setTimeout(()=>message.remove(),3000);
}

async function addMemory(){
  const file = fileInput.files[0];
  const memoryText = document.getElementById('memoryText');
  const text = memoryText.value.trim();
  if(!file||!text){ alert("·ûü·ûº·ûò·ûá·üí·ûö·ûæ·ûü·ûö·ûæ·ûü·ûö·ûº·ûî ·ûì·û∑·ûÑ·ûü·ûö·ûü·üÅ·ûö·û¢·ûè·üí·ûê·ûî·ûë·ûá·û∂·ûò·ûª·ûì·ûü·û∑·ûì!"); return; }
  const path = `memories/${Date.now()}-${file.name}`;
  const storageRef = ref(storage,path);
  await uploadBytes(storageRef,file);
  const imageURL = await getDownloadURL(storageRef);
  const now = new Date().toLocaleString('en-US',{year:'numeric',month:'long',day:'numeric',hour:'2-digit',minute:'2-digit'});
  await addDoc(memoriesCol,{image:imageURL,text,date:now,path});
  fileInput.value=""; memoryText.value=""; previewImage.style.display="none"; sizeDisplay.textContent="";
  showSuccessMessage();
}

function renderMemories(arr){
  const grid=document.getElementById('memoriesGrid'); grid.innerHTML="";
  if(arr.length===0){ grid.innerHTML='<div class="no-memories">No memories yet.</div>'; return; }
  arr.forEach(mem=>{
    const card=document.createElement('div'); card.className='memory-card';
    card.innerHTML=`
      <div class="memory-card-hearts"><div class="heart">‚ô•</div><div class="heart">‚ô•</div><div class="heart">‚ô•</div><div class="heart">‚ô•</div></div>
      <button class="delete-btn" onclick="deleteMemory('${mem.id}','${mem.path||""}')">√ó</button>
      <img src="${mem.image}" class="memory-image">
      <div class="memory-text">${mem.text}</div>
      <div class="memory-date">${mem.date}</div>
    `;
    grid.appendChild(card);
  });
}

const q=query(memoriesCol,orderBy("date","desc"));
onSnapshot(q,snap=>{ const arr=[]; snap.forEach(d=>arr.push({id:d.id,...d.data()})); renderMemories(arr); });

async function deleteMemory(id,path){
  if(!confirm("Are you sure you want to delete this memory?")) return;
  await deleteDoc(doc(db,"memories11J",id));
  if(path){ try{ await deleteObject(ref(storage,path)); }catch(e){} }
}

const style=document.createElement('style');
style.textContent=`@keyframes slideIn{from{transform:translateX(100%);opacity:0;}to{transform:translateX(0);opacity:1;}}`;
document.head.appendChild(style);

window.addMemory=addMemory; window.deleteMemory=deleteMemory;
</script>
</body>
</html>